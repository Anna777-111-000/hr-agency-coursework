{% extends 'base.html' %}

{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - HR Agency{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h1>
    <p class="lead">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã –ø–æ –ø–æ–¥–±–æ—Ä—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∞</p>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ -->
    <div class="row mb-5">
        <div class="col-md-4 mb-3">
            <div class="card text-white bg-primary">
                <div class="card-body text-center">
                    <h5 class="card-title">–ö–∞–Ω–¥–∏–¥–∞—Ç–æ–≤</h5>
                    <p class="card-text display-4">{{ candidates_count }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card text-white bg-success">
                <div class="card-body text-center">
                    <h5 class="card-title">–í–∞–∫–∞–Ω—Å–∏–π</h5>
                    <p class="card-text display-4">{{ vacancies_count }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card text-white bg-warning">
                <div class="card-body text-center">
                    <h5 class="card-title">–û—Ç–∫–ª–∏–∫–æ–≤</h5>
                    <p class="card-text display-4">{{ responses_count }}</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–∫–ª–∏–∫–æ–≤ -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üìà –°—Ç–∞—Ç—É—Å—ã –æ—Ç–∫–ª–∏–∫–æ–≤</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏:</span>
                        <span class="badge bg-warning">{{ pending_responses }}</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>–û–¥–æ–±—Ä–µ–Ω–æ:</span>
                        <span class="badge bg-success">{{ approved_responses }}</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>–û—Ç–∫–ª–æ–Ω–µ–Ω–æ:</span>
                        <span class="badge bg-danger">{{ rejected_responses }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∞–∫–∞–Ω—Å–∏–π -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üíº –°—Ç–∞—Ç—É—Å—ã –≤–∞–∫–∞–Ω—Å–∏–π</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>–û—Ç–∫—Ä—ã—Ç—ã–µ:</span>
                        <span class="badge bg-success">{{ open_vacancies }}</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>–ó–∞–∫—Ä—ã—Ç—ã–µ:</span>
                        <span class="badge bg-secondary">{{ closed_vacancies }}</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>–ß–µ—Ä–Ω–æ–≤–∏–∫–∏:</span>
                        <span class="badge bg-warning">{{ draft_vacancies }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üîß –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –Ω–∞–≤—ã–∫–∏</h5>
                </div>
                <div class="card-body">
                    {% if popular_skills %}
                        {% for skill in popular_skills %}
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span>{{ skill.name }}</span>
                            <div>
                                <span class="badge bg-primary me-1">{{ skill.candidate_count }} –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤</span>
                                <span class="badge bg-info">{{ skill.vacancy_count }} –≤–∞–∫–∞–Ω—Å–∏–π</span>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted">–î–∞–Ω–Ω—ã–µ –æ –Ω–∞–≤—ã–∫–∞—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∫–ª–∏–∫–∏ -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üïê –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∫–ª–∏–∫–∏</h5>
                </div>
                <div class="card-body">
                    {% if recent_applications %}
                        {% for application in recent_applications %}
                        <div class="mb-3 pb-2 border-bottom">
                            <div class="d-flex justify-content-between">
                                <strong>{{ application.candidate.first_name }} {{ application.candidate.last_name }}</strong>
                                <span class="badge
                                    {% if application.status == 'approved' %}bg-success
                                    {% elif application.status == 'rejected' %}bg-danger
                                    {% else %}bg-warning{% endif %}">
                                    {{ application.get_status_display }}
                                </span>
                            </div>
                            <small class="text-muted">–Ω–∞ {{ application.vacancy.title }}</small><br>
                            <small>{{ application.applied_date|date:"d.m.Y H:i" }}</small>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted">–ù–µ—Ç –æ—Ç–∫–ª–∏–∫–æ–≤</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}